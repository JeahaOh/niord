
<div class="row" ng-controller="TemplateExecutionDialogCtrl">

    <div class="col-sm-12 col-md-7">


        <form method="post" name="editForm" id="editForm">
            <div class="editor-fields" style="margin-bottom: 20px; padding-top: 0">

                <!-- ******************************************** -->
                <!-- ** >>>> Message Preamble Header           ** -->
                <!-- ******************************************** -->
                <div class="row template-dialog-param-group" style="margin-top: 0;">
                    <div class="col-sm-12">General</div>
                </div>

                <!-- ********************* -->
                <!-- ** Type            ** -->
                <!-- ********************* -->
                <template-dialog-param-field field-title="msg.field.type" ng-if="showStdTemplateField['type']">

                    <div class="btn-group" ng-if="message.mainType == 'NW'">
                        <button class="btn btn-default btn-sm" ng-model="message.type" uib-btn-radio="'LOCAL_WARNING'"
                                tabindex="201" translate>msg.type.LOCAL_WARNING</button>
                        <button class="btn btn-default btn-sm" ng-model="message.type" uib-btn-radio="'COASTAL_WARNING'"
                                tabindex="202"  translate>msg.type.COASTAL_WARNING</button>
                        <button class="btn btn-default btn-sm" ng-model="message.type" uib-btn-radio="'SUBAREA_WARNING'"
                                tabindex="203"  translate>msg.type.SUBAREA_WARNING</button>
                        <button class="btn btn-default btn-sm" ng-model="message.type" uib-btn-radio="'NAVAREA_WARNING'"
                                tabindex="204"  translate>msg.type.NAVAREA_WARNING</button>
                    </div>
                    <div class="btn-group" ng-if="message.mainType == 'NM'">
                        <button class="btn btn-default btn-sm" ng-model="message.type" uib-btn-radio="'TEMPORARY_NOTICE'"
                                tabindex="205"  translate>msg.type.TEMPORARY_NOTICE</button>
                        <button class="btn btn-default btn-sm" ng-model="message.type" uib-btn-radio="'PRELIMINARY_NOTICE'"
                                tabindex="206"  translate>msg.type.PRELIMINARY_NOTICE</button>
                        <button class="btn btn-default btn-sm" ng-model="message.type" uib-btn-radio="'PERMANENT_NOTICE'"
                                tabindex="207"  translate>msg.type.PERMANENT_NOTICE</button>
                        <button class="btn btn-default btn-sm" ng-model="message.type" uib-btn-radio="'MISCELLANEOUS_NOTICE'"
                                tabindex="208"  translate>msg.type.MISCELLANEOUS_NOTICE</button>
                    </div>
                </template-dialog-param-field>


                <!-- ********************* -->
                <!-- ** Message ID      ** -->
                <!-- ********************* -->
                <template-dialog-param-field field-title="msg.field.id" ng-if="showStdTemplateField['id']">

                    <table class="editor-field-value-table">
                        <tr>
                            <th>Message series</th>
                            <td>
                                <select class="form-control input-sm" style="width: 200px"
                                        tabindex="301"
                                        ng-model="message.messageSeries"
                                        ng-options="series.seriesId for series in messageSeries">
                                </select>
                            </td>
                        </tr>
                    </table>

                </template-dialog-param-field>


                <!-- ********************* -->
                <!-- ** Publish Date    ** -->
                <!-- ********************* -->
                <template-dialog-param-field field-title="msg.field.publish_date" ng-if="showStdTemplateField['publish_date']">

                    <div class="row">
                        <div class="col-xs-6 col-sm-6 col-md-6">
                            <date-time-picker ng-model="message.publishDateFrom" placeholder="Publish From" format="'lll z'"
                                              readonly="message.status != 'DRAFT' && message.status != 'VERIFIED'"
                                              tab-index="601"></date-time-picker>
                        </div>
                        <div class="col-xs-6 col-sm-6 col-md-6">
                            <date-time-picker ng-model="message.publishDateTo" placeholder="Publish To" format="'lll z'"
                                              readonly="message.status != 'DRAFT' && message.status != 'VERIFIED'  && message.status != 'PUBLISHED'"
                                              tab-index="601"></date-time-picker>
                        </div>
                    </div>

                </template-dialog-param-field>


                <!-- ********************* -->
                <!-- ** Areas           ** -->
                <!-- ********************* -->
                <template-dialog-param-field field-title="msg.field.areas" ng-if="showStdTemplateField['areas']">

                    <div class="row">
                        <div class="col-sm-12">
                            <areas-field id="areas" area-data="message" multiple="true" domain="domain"></areas-field>
                        </div>
                    </div>
                    <div class="row" style="margin-top: 10px">
                        <div class="col-sm-6" ng-repeat="desc in message.descs">
                            <input class="form-control input-sm" placeholder="Vicinity" type="text"
                                   tabindex="704"
                                   ng-model="desc.vicinity" bg-flag="desc.lang"
                                   ng-model-options="{ updateOn: 'default blur', debounce: { default: 500, blur: 0 } }">
                        </div>
                    </div>

                </template-dialog-param-field>



                <!-- ******************************************** -->
                <!-- ** >>>> Templates                         ** -->
                <!-- ******************************************** -->
                <div ng-repeat="template in templates">

                    <div class="row template-dialog-param-group">
                        <div class="col-sm-12">{{template.descs[0].name}}</div>
                    </div>

                    <!-- ********************* -->
                    <!-- ** Positions       ** -->
                    <!-- ********************* -->
                    <template-dialog-param-field field-title="msg.field.positions" ng-if="showStdTemplateField['positions']">

                        <div class="row">
                            <div class="col-sm-12">
                                <gj-editor id="position-editor"
                                           class="template-message-map"
                                           edit-type="message"
                                           feature-collection="message.parts[$index].geometry"
                                           show-wms-layer="true"
                                           on-save="computeAreas()"></gj-editor>
                            </div>
                        </div>

                    </template-dialog-param-field>


                </div>

            </div>

        </form>

    </div>

    <div class="col-sm-12 col-md-5">
        <div class="message-status-lang" style="text-align: center;">
            <span style="text-align: left">
                Preview &nbsp;
                <span ng-repeat="lang in modelLanguages" ng-click="previewLanguage(lang)"
                      style="padding-top: 4px; padding-bottom: 4px"
                      class="message-status-lang-btn pointer"
                      ng-class="{'preview-lang-selected' : previewLang == lang}">
                    <img ng-src="/img/flags/{{lang}}.png" height="14"/>
                    {{'lang.' + lang | translate}}
                </span>
            </span>
        </div>

        <table ng-if="previewMessage" class='table table-condensed'>
            <tr render-message-details
                msg="previewMessage"
                language="previewLang"
                format="details"
                show-promulgation="true"
                show-details-menu="false"></tr>
        </table>
    </div>
</div>
